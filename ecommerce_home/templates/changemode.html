<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>{% block title %}Ecommerce Site{% endblock %}</title>
  {% load static %}

  <!-- FAVICONS (must NOT be inside <style>) -->
  <link rel="icon" href="{% static 'images/favicon.ico' %}" sizes="any">
  <link rel="icon" type="image/png" sizes="32x32" href="{% static 'images/favicon-32.png' %}">
  <link rel="icon" type="image/png" sizes="16x16" href="{% static 'images/favicon-16.png' %}">
  <link rel="apple-touch-icon" sizes="180x180" href="{% static 'images/favicon/apple-touch-icon.png' %}">
  <link rel="icon" type="image/png" sizes="512x512" href="{% static 'images/favicon-512.png' %}">

  <style>
    :root { --brand:#2874f0; --header-h:64px; }
    html, body { height:100%; margin:0; padding:0; }
    body.light-mode { background:#fff; color:#222; }
    body.dark-mode  { background:#222; color:#fff; }
    .topbar{ position:sticky; top:0; z-index:1000; height:var(--header-h);
             display:flex; align-items:center; gap:12px; padding:0 16px;
             background:var(--brand); color:#fff; box-shadow:0 1px 0 rgba(0,0,0,.1); }
    .brand{ font-weight:900; font-size:22px; letter-spacing:.2px; text-decoration:none; color:#fff; }
    .spacer{ flex:1; }
    #theme-toggle{ font-size:20px; border:0; background:none; color:#fff; cursor:pointer;
                   border-radius:50%; width:44px; height:44px; display:flex; align-items:center; justify-content:center;
                   transition:background .2s; position:relative; }
    #theme-toggle:hover{ background:rgba(255,255,255,.12); }
    .theme-tooltip{ display:none; position:absolute; left:50%; top:110%; transform:translateX(-50%);
                    background:#232323; color:#fff; padding:7px 16px; border-radius:6px; font-size:14px;
                    box-shadow:0 2px 8px rgba(0,0,0,.18); white-space:nowrap; margin-top:7px; z-index:99;
                    pointer-events:none; opacity:0; transition:opacity .15s; }
    #theme-toggle:hover .theme-tooltip{ display:block; opacity:1; }
    .theme-tooltip::before{ content:""; position:absolute; top:-7px; left:50%; transform:translateX(-50%);
                            border-width:0 7px 7px; border-style:solid; border-color:transparent transparent #232323; }
    main{ min-height: calc(100vh - var(--header-h)); }
    .topbar a.brand,
    .topbar a.brand:link,
    .topbar a.brand:visited,
    .topbar a.brand:hover,
    .topbar a.brand:focus{ text-decoration:none !important; color:#fff; }
    .topbar a.brand:focus-visible{ outline:2px solid rgba(255,255,255,.6); outline-offset:2px; }
  </style>

  {% block extra_style %}{% endblock %}
</head>

<body class="light-mode">
  <header class="topbar" role="banner">
    <a class="brand" href="/api/paginate/">Novacart</a>
    <div class="spacer"></div>

    <!-- Theme Toggle Button with SVG icons and tooltip -->
    <button id="theme-toggle" aria-label="Toggle dark/light mode">
      <!-- Moon Icon (for light mode) -->
      <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
        <path fill="currentColor" d="M21 15.3A9 9 0 1 1 12.7 3a7 7 0 1 0 8.3 12.3z"/>
      </svg>
      <!-- Sun Icon (for dark mode) -->
      <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" style="display:none;" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="5" stroke="currentColor" stroke-width="2" fill="none"/>
        <g stroke="currentColor" stroke-width="2">
          <line x1="12" y1="1" x2="12" y2="3"/>
          <line x1="12" y1="21" x2="12" y2="23"/>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
          <line x1="1" y1="12" x2="3" y2="12"/>
          <line x1="21" y1="12" x2="23" y2="12"/>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
        </g>
      </svg>
      <span class="theme-tooltip" id="theme-tooltip">Switch to dark mode</span>
    </button>
  </header>

  <main>
    {% block content %}{% endblock %}
  </main>

  <script>
    // You said you'll remove this later if not needed; works as-is for now.
    function setTheme(mode) {
      const moonIcon = document.getElementById('moon-icon');
      const sunIcon  = document.getElementById('sun-icon');
      const tooltip  = document.getElementById('theme-tooltip');

      if (mode === 'dark') {
        document.body.classList.add('dark-mode');
        document.body.classList.remove('light-mode');
        sunIcon.style.display  = '';
        moonIcon.style.display = 'none';
        tooltip.textContent = 'Switch to Light Mode';
      } else {
        document.body.classList.add('light-mode');
        document.body.classList.remove('dark-mode');
        moonIcon.style.display = '';
        sunIcon.style.display  = 'none';
        tooltip.textContent = 'Switch to Dark Mode';
      }
    }

    let savedTheme = localStorage.getItem('theme');
    setTheme(savedTheme === 'dark' ? 'dark' : 'light');

    document.getElementById('theme-toggle').onclick = function () {
      let newTheme = document.body.classList.contains('dark-mode') ? 'light' : 'dark';
      setTheme(newTheme);
      localStorage.setItem('theme', newTheme);
    };
  </script>
</body>
</html>
